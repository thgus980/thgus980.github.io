---
layout: single
title:  "[2025-10-12] 20251012 개발일지"
categories: devlog
toc: true
---

## MCP 서버 구축

### 1. 사용자의 질의가 모호할 경우
- Claude Desktop은 어떤 툴이 적절한지 판단하지 못해 아예 툴을 호출하지 않을 수도 있음
- 해결법:
  1. 특정 주제에 대해서 거의 모든 질문과 매칭될 수 있도록, 매우 폭넓고 관대한 툴 설명을 작성한다. (예) -에 관한 모든 질문에 답합니다.
  2. 툴 내부에서, 모호한 경우를 위해 안내 메시지가 포함된 스마트 라우팅을 구현한다
  3. 스마트 라우팅 예시
     ```python
     @mcp.tool()
      async def query_terminology(question: str) -> str:
          """
          용어 사전, 용어 정의, 카테고리에 대한 질문에 답합니다.
          자연어 질문을 입력으로 받습니다.
          """
          question_lower = question.lower()
      
          # 의도(intention)에 따라 라우팅
          if any(keyword in question_lower for keyword in ["what does", "define", "meaning of", "무슨 뜻"]):
              # 용어를 추출해 정의를 조회
              pass
          elif any(keyword in question_lower for keyword in ["categories", "types", "classification"]):
              # 카테고리 정보를 반환
              pass
          elif any(keyword in question_lower for keyword in ["dictionary", "statistics", "information"]):
              # 사전 메타데이터를 반환
              pass
          else:
              # 안내 메시지 반환
              return """제가 도와드릴 수 있는 내용:
              - 용어 정의 (예: "객단가가 무슨 뜻이야?")
              - 카테고리 정보 (예: "용어 카테고리를 보여줘")
              - 사전 정보 (예: "사전에 대해 알려줘")
      
              무엇을 알고 싶으신가요?"""
     ```
   - 핵심은 툴 설명을 충분히 넓게 작성해, Claude가 거의 모든 용어 관련 질문에 이 툴을 호출하도록 만들고, 그 다음 라우팅이나 명확한 질문은 툴 내부에서 처리하게 하는 것
   - 다만 "오늘 날씨 어때?"처럼 특정 주제와는 전혀 무관한 질문을 하면 해당 방식도 한계가 있음
