---
layout: single
title:  "[2025-08-09] 20250809 개발일지"
categories: devlog
toc: true
---

## 파이썬 업무 자동화 스크립트 작성: 입사지원서 자동 작성

### 플레이스 홀더 방식
- 개념
  1. 템플릿 엑셀의 원하는 셀에 {{필드명}} 또는 {{필드명|변환|변환...}} 형태로 표기하면, 원천(raw) 엑셀의 각 행 값을 읽어 자동 치환  
  2. 셀 서식(폰트, 병합, 테두리, 수식 등)은 유지되고 값만 바뀜
- 문법
  1. 기본형: {{ 필드명 }} → 원천 엑셀의 컬럼명과 동일해야 합니다.
  2. 파이프 변환: {{ 필드명 | 변환1 | 변환2:인자 ... }} (좌→우 순서로 적용)
  3. 그 외 변환들 (스크립트에 직접 구현):
    - trim: 앞뒤 공백 제거
    - upper / lower: 대문자/소문자
    - zfill:N: 자릿수 N까지 왼쪽 0 채움
    - digits: 숫자만 남기기(전화번호 등)
    - date:입력포맷->출력포맷: 날짜 문자열 변환 (예: date:%Y-%m-%d->%Y.%m.%d)
    - map:키=값,키=값...: 값 매핑 (예: map:남=Male,여=Female)
- 템플릿 설계 가이드
  1. 원천 엑셀 컬럼명을 먼저 확정하고, 템플릿에 같은 이름으로 플레이스홀더를 씁니다. 셀 어디든 문장 중간에 넣어도 됩니다. -> 예: 이름: {{이름}}, 생년월일: {{생년월일|date:%Y-%m-%d->%Y.%m.%d}}
  2. 병합셀/서식/수식은 그대로 두고, 값만 플레이스홀더로 교체하세요.
  3. 파일명 규칙은 스크립트의 FILENAME_PATTERN에서 Python 포맷을 사용합니다. -> 예: "{지원서번호}_{이름}.xlsx"
- Raw Data의 한 셀에 줄 바꿈으로 여러 데이터를 기입한 방식의 경우 **수동 매핑 (split_line 변환)** 방법을 사용
  - 수동 매핑: 템플릿에서 각 줄을 개별적으로 지정
  - 예: `{{필드|split_line:0}}`, `{{필드|split_line:1}}`, `{{필드|split_line:2}}`
  - 장점: 간단, 안정적, 각 항목의 위치를 정확히 제어
  - 단점: 데이터 개수가 바뀌면 템플릿 수정 필요
