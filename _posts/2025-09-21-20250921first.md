---
layout: single
title:  "[2025-09-21] 20250921 개발일지"
categories: devlog
toc: true
---

## 강좌명: 자바와 스프링 부트로 생애 최초 서버 만들기, 누구나 쉽게 개발부터 배포까지! [서버 개발 올인원 패키지]

### Github Repository
https://github.com/thgus980/library-app

### 1. 배포
- 배포? 최종 사용자에게 SW를 전달하는 과정 = 전용 컴퓨터에 우리의 서버(코드 등)를 옮겨 실행시키는 것
- AWS 홈페이지를 이용해서 컴퓨터를 빌리자
- 서버 컴퓨터는 보통 운영체제로 리눅스를 사용

### 2. profile과 H2
- profile? 똑같은 서버 코드를 실행시키지만, 실행될 때 설정을 다르게 하고 싶다 (우리 컴퓨터에서 실행하면 우리 mysql을 쓰고 전용 컴퓨터에서 실행하면 전용 컴퓨터의 mysql을 사용하도록)
- 목표: 똑같은 서버 코드를 실행시키지만, local이라는 profile을 입력하면, H2 DB를 사용하고 dev라는 profile을 입력하면 MySQL DB를 사용하게 바꾸자
- application.yml를 아래와 같이 설정
```yml
    spring:
    profiles:
        active: dev  # 기본 프로필 설정 (프로필 섹션 밖에 위치)

    ---
    spring:
    config:
        activate:
        on-profile: local
    datasource:
        url: "jdbc:h2:mem:library;MODE=MYSQL;NON_KEYWORDS=USER;DATABASE_TO_LOWER=TRUE"
        username: "sa"
        password: ""
        driver-class-name: org.h2.Driver
    jpa:
        hibernate:
        ddl-auto: create
        properties:
        show_sql: true
        format_sql: true
        dialect: org.hibernate.dialect.H2Dialect
    h2:
        console:
        enabled: true
        path: /h2-console

    ---
    spring:
    config:
        activate:
        on-profile: dev
    datasource:
        url: "jdbc:mysql://localhost/library"
        username: "root"
        password: "thgus980"
        driver-class-name: com.mysql.cj.jdbc.Driver
    jpa:
        hibernate:
        ddl-auto: none
        properties:
        show_sql: true
        format_sql: true
        dialect: org.hibernate.dialect.MySQL8Dialect
```

### 3. AWS EC2 이용하기
- EC2? AWS EC2(Amazon Elastic Compute Cloud)는 아마존 웹 서비스(AWS)에서 제공하는 클라우드 속 가상 컴퓨터를 빌려 쓰는 서비스
- 인스턴스? 클라우드에서 빌리는 가상 컴퓨터 한 대 한 대를 의미. CPU, 메모리, 저장 공간 등의 사양이 정해져 있음
- AWS EC2 접근 방법
    1. 다운로드 받은 키 페어를 이용하는 방법: ssh -i 경로/키페어이름.pem ec2-user@IP
    2. AWS 콘솔을 활용하는 방법

### 4. 리눅스 명령어
- mkdir: 폴더를 만드는 명령어
- ls: 현재 위치에서 폴더나 파일을 확인하는 명령어
- ls -l: 조금더 상세한 정보를 함께 표시
- cd: 폴더 안으로 들어가는 명령어
- pwd: 현재 위치를 확인하는 명령어
- cd ..: 상위 폴더로 올라가는 명령어
- rmdir: 비어 있는 폴더(디렉토리)를 제거하는 명렁어

### 5. 리눅스에서 스프링 서버 배포하기
- sudo yum update
- sudo yum install git
- sudo yum install java-11-amazon-corretto -y
- wget https://dev.mysql.com/get/mysql80-community-release-el7-5.noarch.rpm -> sudo rpm -ivh mysql80-community-release-el7-5.noarch.rpm -> sudo yum install mysql-community-server
- sudo systemctl status 프로그램: 프로그램의 상태를 확인
- sudo systemctl restart 프로그램: 프로그램을 재시작
- chmod: 파일이나 폴더의 권한을 변경
- 소스 코드 수정이 있었다면, 원격 저장소 github도 최신화 해주기
- github에 올려둔 코드 리눅스에 clone -> git clone [github 저장소 주소]
- swap 설정? ram이 부족할 경우 disk 쓸 수 있도록 설정해주는 것
- 프로젝트를 빌드하여 (./gradlew build -x test) JAR 파일 생성 -> 빌드된 JAR 파일을 이용해서 서버를 실행 시키는 것
- 자바 실행: java -jar 경로 --spring.profiles.active=dev
- Jar 파일을 실행만 했는데 서버가 동작하는 이유? Spring Boot에서는 톰캣이 내장되어 있어 가능한 것
- 톰캣? 웹 애플리케이션 서버(WAS)의 한 종류로, 요청이 들어오면 그 요청을 약속된 형식에 맞추어 스프링에 전달해준다!
- 이렇게 배포를 수동으로 진행했지만 자동(CI/CD)으로 할 수 있는 여러 방법이 있다! -> 배포 자동화

### 6. 종료되지 않는 실행
- AWS EC2 접속을 종료하더라도 서버가 계속 살아있도록 처리해보기
- 리눅스에서 background로 동작하게 만드는 명령어: nohup [명령어] &
- (예) nohup java -jar 경로 --spring.profiles.active=dev &
- background로 동작하는 서버 종료하는 방법?
    1. ps aux: 현재 실행중인 프로그램 목록을 확인할 수 있다
    2. ps aux | grep java
    3. kill -9 프로그램번호: 해당 프로그램을 종료시킨다

### 7. 가비아를 이용한 도메인 구입, DNS 적용
- 원래대로라면 주소창에 IP 주소를 입력해서 접속했지만, 가비아에서 도메인을 구입한 후 도메인에 대한 레코드를 특정 IP로 등록해줬기 때문에, 이름만 가지고 사이트 접속 가능

### 8. 강의에서 다룬 내용
- 언어: Java
- 빌드툴: Gradle
- 서버 프레임워크: Spring Boot
- DB 접근 기술: JPA
- DB: MySQL

### 9. 추가
- WAS?
    - 웹 서버: 정적 자원을 클라이언트에게 바로 전달 (Apache, Nginx)
    - WAS: 동적 자원을 만드는 곳 -> 웹 서버에게 전달
    - Java의 경우
        - 웹 서버: Nginx
        - WAS: 톰캣
        - 애플리케이션: Spring 프레임워크로 만든 코드
    - Python의 경우
        - 웹 서버: Nginx
        - WAS: Uvicorn
        - 애플리케이션: FastAPI 프레임워크로 만든 코드
    - **결론적으로 WAS는 웹 서버로 받은 동적인 요청을 처리하기 위해, 실제 애플리케이션 코드를 실행하고 그 결과를 다시 웹 서버에게 돌려주는 미들웨어**
- 마크업 언어?
    - 태그 등을 사용하여 문서의 구조와 서식을 지정하는 언어
    - 종류: HTML, XML, Markdown