---
layout: single
title:  "[2026-02-08] 20260208 개발일지"
categories: devlog
toc: true
---

## 메타데이터 질문에 응답하는 챗봇 설계

### 질문 분류 프롬프트 업데이트
- 설명: 메타데이터 질문을 감지하고 metadata_type 필드를 도입하기 위함
- 기존: greeting, summary_request 등 총 5가지로만 분류
- 수정 사항: metadata_qeury 유형 추가
  - total_count: 전체 단어 수
  - category_list: 카테고리 목록
  - count_by_category: 카테고리별 개수
  - help_usage: 사용법 가이드
  - 통계나 사용법에 대한 질문은 metadata_query로 분류하고, 적절한 metadata_type을 명시하도록 지시

### JSON 파싱 로직 업데이트
- 설명: LLM이 응답한 결과에서 metadata_type을 추출하여 서비스 로직으로 전달하기 위함
- 다음의 필드를 새로 추출 -> `metadata_type = result.get('metadata_type', None)`
- 에러가 발생하거나 기본값으로 돌아갈 때 metadata_type: None을 포함하여 반환하도록 수정

### 새로운 메서드 추가
- 설명: DB에서 가져온 통계 데이터를 바탕으로 자연스러운 한국어 답변을 생성하는 전용 함수를 만들기
- 핵심로직
  1. metadata_type에 따라 DB 저장소의 메서드를 호출
  2. DB 결과를 텍스트 정보로 변환
  3. Bedrock LLM에게 이 정보를 포함한 프롬프트를 전달하여 최종 답변을 생성

### 메인 쿼리 파이프라인 재작성
- 설명: 질문 유형에 따라 적절한 로직으로 안내하는 역할 강화
- 수정 사항
  1. 질문 분류: LLM을 통해 질문 유형과 메타데이터 유형 파악
  2. 분기 처리: metadata_query인 경우, 그 외 일반 질문인 경우, 용어 검색인 경우
- 결과 반환: 답변과 세션 정보를 담아 프론트엔드로 전달
