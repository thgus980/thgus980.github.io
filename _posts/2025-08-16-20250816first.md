---
layout: single
title:  "[2025-08-16] 20250816 개발일지"
categories: devlog
toc: true
---

## 강좌명: 자바와 스프링 부트로 생애 최초 서버 만들기, 누구나 쉽게 개발부터 배포까지! [서버 개발 올인원 패키지]

### Github Repository
https://github.com/thgus980/library-app

### 1. 문자열 SQL을 직접 사용하는 것이 너무 어렵다 - 그래서 등장한 JPA
- JPA란? 객체와 관계형 DB의 테이블을 짝지어 데이터를 영구적으로 저장할 수 있도록 정해진 Java 진영의 규칙, 자바 진영의 ORM -> Java Persistence API
- JPA를 구현한 코드가 Hibernate -> 구현(implement)체
- JPA(ORM)은 규칙(interface)일 뿐이고, 실제 구현은 Hibernate를 통해 한다. 이때 이 Hibernate는 내부적으로 JDBC를 사용한다.

### 2. 유저 테이블에 대응되는 Entity Class 만들기
- @Entity: 스프링이 User 객체와 user 테이블을 같은 것으로 바라본다.
- Entity: 저장되고, 관리되어야 하는 데이터 (User)
- @Id: 이 필드를 primary key로 간주한다.
- @GeneratedValue: primary key는 자동 생성되는 값이다.
- @Column: 객체의 필드와 Table의 필드를 매핑한다.

### 3. JpaRepository
- JpaRepository를 상속하여 사용한 기능: save, findAll, findById
```java
public interface UserRepository extends JpaRepository<User, Long> { // User의 id가 Long 타입이기 때문에
}
```
```java
@Service
public class UserServiceV2 { // JPA 사용하는 버전
    private final UserRepository userRepository;

    public UserServiceV2(UserRepository userRepository) {
        this.userRepository=userRepository;
    }

    public void saveUser(UserCreateRequest request){
        // save된 User 반환
        User u= userRepository.save(new User(request.getName(), request.getAge())); //save 메소드에 객체를 넣어주면 INSERT SQL이 자동으로 날라간다
        // u.getId();
    }

    public List<UserResponse> getUsers() {
        return userRepository.findAll().stream().map(user -> new UserResponse(user.getId(), user.getName(), user.getAge())).collect(Collectors.toList());
    }
    
    public void updateUser(UserUpdateRequest request) {
        //select * from user where id=?;
        //결과는 Optional<User>
        User user=userRepository.findById(request.getId()).orElseThrow(IllegalArgumentException::new); // 유저가 없다면 예외가 나간다
        
        user.updateName(request.getName()); //객체를 변경
        userRepository.save(user); //바뀐 user 기반으로 update 쿼리 날라감
    }
}
```

### 4. 구조
- Spring Data JPA(스프링에서 JPA를 더 쉽게 쓸 수 있도록 JPA를 한번 더 감쌈) -> JPA(ORM) -> Hibernate(JPA 구현체) -> JDBC
- 좀 더 간편하게 사용할 수 있도록 위와 같은 순서로 발전되었다!
