---
layout: single
title:  "[2026-03-01] 20260301 개발일지"
categories: devlog
toc: true
---

## AWS Certified Solutions Architect – Associate (SAA)

### NAT Gateway
- Q. 보안 강화를 위해 데이터베이스 서버를 프라이빗 서브넷에 배치했습니다. 이 서버는 외부 인터넷에서 직접 접속할 수는 없어야 하지만, 보안 패치를 위해 인터넷에 있는 외부 리포지토리에 접근하여 업데이트 파일을 다운로드해야 합니다. 가장 적절한 네트워크 구성은 무엇입니까?
  1. 데이터베이스 서버에 퍼블릭 IP를 할당하고 보안 그룹에서 80/443 포트만 허용한다.
  2. 퍼블릭 서브넷에 NAT 게이트웨이를 생성하고, 프라이빗 서브넷의 라우팅 테이블이 이 NAT 게이트웨이를 거쳐 인터넷으로 나가도록 설정한다.
  3. 프라이빗 서브넷에 NAT 게이트웨이를 생성하고, 라우팅 테이블을 인터넷 게이트웨이(IGW)로 연결한다.
  4. 네트워크 ACL(NACL)의 인바운드 규칙에서 모든 외부 IP를 허용(Allow)으로 설정한다.
- A. 2번 (NAT 게이트웨이는 아웃바운드 통신만 허용하고 외부에서의 인바운드는 차단하므로, 프라이빗 서버의 보안을 유지하면서 업데이트를 받는 표준 방식)

### VPC Endpoint
- Q. [상황] 프라이빗 서브넷에 있는 EC2 인스턴스가 S3 버킷에 대량의 데이터를 업로드해야 합니다. 현재는 보안을 위해 인터넷 게이트웨이가 없어서 NAT 게이트웨이를 통해 인터넷을 거쳐 S3에 접속하고 있습니다. 하지만 데이터 양이 너무 많아져서 NAT 게이트웨이의 데이터 처리 비용이 감당하기 힘들 정도로 많이 나오고 있습니다.
- [요구사항] 인터넷을 거치지 않고 AWS 내부 네트워크망을 통해 S3에 직접 접속해야 함. NAT 게이트웨이 비용을 절감해야 함. 보안을 위해 트래픽이 공용 인터넷으로 나가지 않아야 함.
- A. [해결책: VPC 엔드포인트 (Gateway 타입)] 이 상황에서 가장 적절한 정답은 **"S3용 게이트웨이 VPC 엔드포인트(Gateway VPC Endpoint)를 생성하고 라우팅 테이블에 추가한다"**
- VPC 엔드포인트란? VPC 내부에 있는 리소스(EC2 등)가 AWS의 다른 서비스(S3, DynamoDB 등)와 통신할 때, 인터넷을 통하지 않고 AWS 내부망으로만 연결해주는 '전용 통로'.
- VPC 엔드포인트 장점?
  1. 비용 절감 (S3 & DynamoDB 특화) -> NAT 게이트웨이는 데이터를 주고받을 때마다 GB당 처리 비용이 발생합. 대용량 데이터를 S3에 올리면 비용 폭탄을 맞을 수 있음. 하지만 S3용 게이트웨이 엔드포인트는 무료! 설정만 하면 추가 비용 없이 내부망을 쓸 수 있으니 비용 최적화 가능.
  2. 보안 강화 -> 트래픽이 우리 VPC 밖(인터넷)으로 아예 나가지 않기 때문에, 해커가 중간에서 가로챌 위험이 사라짐. 프라이빗 서브넷의 정체성을 그대로 유지하면서 외부 서비스와 통신하는 방법.
- VPC 엔드포인트의 두 가지 방식 (AWS에서 VPC 내부에 있는 리소스가 인터넷을 거치지 않고 다른 AWS 서비스와 통신하게 해주는 기술을 통칭하여 VPC 엔드포인트라고 부름)
  1. 게이트웨이 엔드포인트
    - 대상 서비스: S3와 DynamoDB 전용
    - 작동 방식: 서브넷의 라우팅 테이블에 "S3로 갈 때는 이 통로를 써!" 라고 이정표를 추가하는 방식(연결 방식: 라우팅 테이블 업데이트)
    - 비용: 무료
    - 보안 그룹: 사용 불가(IAM 정책으로 제어)
    - (참고) 시험 문제에서 S3에 데이터를 엄청나게 많이 보내는데 비용을 아끼고 싶다 -> 무조건 게이트웨이 엔드포인트
    - VPC 엔드포인트를 만드는데 S3니까 게이트웨이 타입을 선택
  2. 인터페이스 엔드포인트
    - 대상 서비스: S3, DynamoDB를 제외한 거의 모든 AWS 서비스(SQS, SNS, Kinesis, EC2 API 등)에 사용됨.
    - 작동 방식: 서브넷 안에 ENI(가상 랜카드)를 꽂아서 내부 IP를 할당받는 방식(연결 방식: 서브넷 내 프라이빗 IP 할당)
    - 비용: 시간당 요금과 데이터 처리 비용이 발생하는 유료 서비스
    - 보안 그룹: 보안 그룹 적용 가능
